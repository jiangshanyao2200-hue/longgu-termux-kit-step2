# UI 冒烟测试：键位 / 流式 / 工具 / PTY

目标：快速确认“能用且不冲突”，避免回归。

## 0. 基础
- 确认能启动 `ying`，且无明显卡顿/闪退。
- 进入 Chat 页：输入为空时测试键位；输入不为空时测试编辑键位不会误触发选择。

## 1. 选择与复制
1) 输入为空，按 `↑`：进入选择模式（从底部开始选）。
2) 按 `↑/↓`：选中移动，且会自动滚动保持可见。
3) `Home`：退出选择模式，并全局收起已展开的思考/工具详情。
3) 复制：
   - `Enter`：复制选中消息到剪贴板。
   - `Alt+↓`：同样复制选中消息（单手更好按）。

预期：复制成功时系统日志出现 `Copied selected message`。

## 2. 思考与工具详情（展开/收起）
前置：先产生一条带思考的 AI 回复，和至少一条工具消息。

- 展开思考：
  1) 选中 **AI 正文消息**。
  2) 按 `←`：展开/收起对应思考（可多条同时展开）。
  说明：如果这条 AI 回复没有可用的思考记录，会提示你“需要选中 AI 正文”或无可展开内容。

- 展开工具详情：
  1) 选中 **工具消息**（Role=Tool）。
  2) 按 `→`：展开/收起工具详情（可多条同时展开）。

## 3. SSE（流式）与非流式切换
### SSE 开启
1) `/SSE Open`
2) 发一条消息

预期：
- thinking 只在 `running` 阶段显示；正文开始后 thinking 立刻隐藏。
- 工具/系统提示不会把屏幕塞满（可用 `→` 展开工具详情回看）。

### SSE 关闭
1) `/SSE Close`
2) 发一条消息

预期：
- 简约模式不显示 thinking；切到详情模式才回看最近 thinking（如存在）。

## 4. 交互终端（PTY，bash interactive）
前置：让 AI 发起工具调用 `bash` 且带 `interactive:true`（例如跑一个需要持续输出/需要输入的命令）。

在 Terminal 视图中：
- `Home`：Terminal ↔ Chat 视图切换（会话不中断）。
- 焦点切换：
  - `↑`（不按 Ctrl）：焦点到 Terminal（按键直接转发给 PTY）。
  - `↓`（不按 Ctrl）：焦点到 Chat Input（本地编辑一行）。
- Chat Input 焦点下：
  - 输入一行，`Enter`：把整行发送给 PTY（补 `\r`），并清空输入框。
- `PgUp/PgDn/滚轮`：只用于回看滚动（不转发给进程）。

预期：
- 输出持续刷新；不会被“选择消息”逻辑打断。
- 结束后 tool output 里能看到终端快照，且 log_lines 包含 `saved:log/bash-cache/...`。
