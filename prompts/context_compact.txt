系统：聊天窗口已达到动态压缩阈值，现在需要压缩（请严格按要求执行）。

你将看到：提示词、fastmemo、动态摘要池、以及最近的聊天记录。

任务：
- 只压缩“本条用户消息之前”的聊天记录（不包含提示词/fastmemo/动态摘要池，也不包含本条用户消息）。
- 仅压缩较旧聊天记录：保留最近 3 轮对话不写入压缩产物（用于保持连贯性）。
- 压缩产物只需一段纯文本：描述聊了什么、记录关键事实/约束/进度/待办，避免失忆。
- 压缩要与动态摘要池形成连续记忆：避免机械重复旧摘要，能增量更新就增量更新。

输出格式（强制）：
- 本轮只允许输出 1 条工具 JSON（不要附加说明/不要输出正文/不要调用其他工具）。
- 工具名固定为 context_compact。

工具 JSON 示例：
<tool>{"tool":"context_compact","target":"{TARGET}","content":"(你的压缩文本)","brief":"↻ context summary"}</tool>

注意：target 必须是 {TARGET}（main 或 dog）。
用户最新消息（不要写入压缩内容）：
{USER}
